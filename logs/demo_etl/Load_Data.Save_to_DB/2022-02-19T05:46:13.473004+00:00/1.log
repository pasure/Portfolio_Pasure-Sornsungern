[2022-02-19 05:46:40,366] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: demo_etl.Load_Data.Save_to_DB manual__2022-02-19T05:46:13.473004+00:00 [queued]>
[2022-02-19 05:46:40,375] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: demo_etl.Load_Data.Save_to_DB manual__2022-02-19T05:46:13.473004+00:00 [queued]>
[2022-02-19 05:46:40,375] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-02-19 05:46:40,376] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-02-19 05:46:40,376] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-02-19 05:46:40,386] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): Load_Data.Save_to_DB> on 2022-02-19 05:46:13.473004+00:00
[2022-02-19 05:46:40,390] {standard_task_runner.py:52} INFO - Started process 16594 to run task
[2022-02-19 05:46:40,402] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'demo_etl', 'Load_Data.Save_to_DB', 'manual__2022-02-19T05:46:13.473004+00:00', '--job-id', '244', '--raw', '--subdir', 'DAGS_FOLDER/demo_etl.py', '--cfg-path', '/tmp/tmp024bwxxo', '--error-file', '/tmp/tmpz_h9jrbe']
[2022-02-19 05:46:40,403] {standard_task_runner.py:77} INFO - Job 244: Subtask Load_Data.Save_to_DB
[2022-02-19 05:46:40,474] {logging_mixin.py:109} INFO - Running <TaskInstance: demo_etl.Load_Data.Save_to_DB manual__2022-02-19T05:46:13.473004+00:00 [running]> on host c39e331ab017
[2022-02-19 05:46:40,530] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=demo_etl
AIRFLOW_CTX_TASK_ID=Load_Data.Save_to_DB
AIRFLOW_CTX_EXECUTION_DATE=2022-02-19T05:46:13.473004+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-02-19T05:46:13.473004+00:00
[2022-02-19 05:46:40,537] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2022-02-19 05:46:40,538] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
[2022-02-19 05:46:40,539] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
[2022-02-19 05:46:40,540] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
[2022-02-19 05:46:40,541] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
[2022-02-19 05:46:40,542] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
[2022-02-19 05:46:40,543] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
[2022-02-19 05:46:40,544] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
[2022-02-19 05:46:40,545] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
[2022-02-19 05:46:40,545] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
[2022-02-19 05:46:40,546] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
[2022-02-19 05:46:40,547] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
[2022-02-19 05:46:40,592] {logging_mixin.py:109} INFO - Done !!
[2022-02-19 05:46:40,663] {logging_mixin.py:109} INFO - Done !!
[2022-02-19 05:46:40,665] {logging_mixin.py:109} INFO - Empty DataFrame
Columns: [VendorID, lpep_pickup_datetime, lpep_dropoff_datetime, RatecodeID, PULocationID, DOLocationID, passenger_count, trip_distance, fare_amount, extra, mta_tax, tip_amount, tolls_amount, improvement_surcharge, total_amount, payment_type, trip_type, congestion_surcharge]
Index: []
[2022-02-19 05:46:40,777] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/mssql/pyodbc.py", line 448, in do_executemany
    cursor, statement, parameters, context=context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 605, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'Unnamed: 0'. (207) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/functions.py", line 69, in savetodb
    df_csv.to_sql(TableName, con=Engine, schema=SchemaName, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/mssql/pyodbc.py", line 448, in do_executemany
    cursor, statement, parameters, context=context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 605, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.ProgrammingError: (pyodbc.ProgrammingError) ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'Unnamed: 0'. (207) (SQLExecDirectW)")
[SQL: INSERT INTO dbo.taxi_2020_2021 ([Unnamed: 0], [Unnamed: 0.1], vendorid, lpep_pickup_datetime, lpep_dropoff_datetime, store_and_fwd_flag, ratecodeid, pulocationid, dolocationid, passenger_count, trip_distance, fare_amount, extra, mta_tax, tip_amount, tolls_amount, improvement_surcharge, total_amount, payment_type, trip_type, congestion_surcharge) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((0, 0, 2, '2019-12-18T15:52:30.000', '2019-12-18T15:54:39.000', 'N', 1, 264, 264, 5, 0.0, 3.5, 0.5, 0.5, 0.01, 0.0, 0.3, 4.81, 1, 1, 0.0), (1, 1, 2, '2020-01-01T00:45:58.000', '2020-01-01T00:56:39.000', 'N', 5, 66, 65, 2, 1.28, 20.0, 0.0, 0.0, 4.06, 0.0, 0.3, 24.36, 1, 2, 0.0), (2, 2, 2, '2020-01-01T00:41:38.000', '2020-01-01T00:52:49.000', 'N', 1, 181, 228, 1, 2.47, 10.5, 0.5, 0.5, 3.54, 0.0, 0.3, 15.34, 1, 1, 0.0), (3, 3, 1, '2020-01-01T00:52:46.000', '2020-01-01T01:14:21.000', 'N', 1, 129, 263, 2, 6.3, 21.0, 3.25, 0.5, 0.0, 0.0, 0.3, 25.05, 2, 1, 2.75), (4, 4, 1, '2020-01-01T00:19:57.000', '2020-01-01T00:30:56.000', 'N', 1, 210, 150, 1, 2.3, 10.0, 0.5, 0.5, 0.0, 0.0, 0.3, 11.3, 1, 1, 0.0), (5, 5, 1, '2020-01-01T00:52:33.000', '2020-01-01T01:09:54.000', 'N', 1, 35, 39, 1, 3.0, 13.5, 0.5, 0.5, 0.0, 0.0, 0.3, 14.8, 1, 1, 0.0), (6, 6, 2, '2020-01-01T00:10:18.000', '2020-01-01T00:22:16.000', 'N', 1, 25, 61, 1, 2.77, 11.0, 0.5, 0.5, 0.0, 0.0, 0.3, 12.3, 2, 1, 0.0), (7, 7, 2, '2020-01-01T01:03:14.000', '2020-01-01T01:29:45.000', 'N', 1, 225, 89, 1, 4.98, 20.5, 0.5, 0.5, 0.0, 0.0, 0.3, 21.8, 2, 1, 0.0)  ... displaying 10 of 2000 total bound parameter sets ...  (1998, 998, 2, '2021-01-02T12:32:45.000', '2021-01-02T12:59:46.000', 'N', 1, 82, 218, 1, 11.88, 35.0, 0.0, 0.5, 0.0, 0.0, 0.3, 35.8, 2, 1, 0.0), (1999, 999, 2, '2021-01-02T12:02:46.000', '2021-01-02T12:09:02.000', 'N', 1, 166, 116, 1, 0.9, 6.0, 0.0, 0.5, 0.0, 0.0, 0.3, 6.8, 2, 1, 0.0))]
(Background on this error at: http://sqlalche.me/e/13/f405)
[2022-02-19 05:46:40,986] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=demo_etl, task_id=Load_Data.Save_to_DB, execution_date=20220219T054613, start_date=20220219T054640, end_date=20220219T054640
[2022-02-19 05:46:41,143] {standard_task_runner.py:92} ERROR - Failed to execute job 244 for task Load_Data.Save_to_DB
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/mssql/pyodbc.py", line 448, in do_executemany
    cursor, statement, parameters, context=context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 605, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'Unnamed: 0'. (207) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/functions.py", line 69, in savetodb
    df_csv.to_sql(TableName, con=Engine, schema=SchemaName, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/mssql/pyodbc.py", line 448, in do_executemany
    cursor, statement, parameters, context=context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 605, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.ProgrammingError: (pyodbc.ProgrammingError) ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'Unnamed: 0'. (207) (SQLExecDirectW)")
[SQL: INSERT INTO dbo.taxi_2020_2021 ([Unnamed: 0], [Unnamed: 0.1], vendorid, lpep_pickup_datetime, lpep_dropoff_datetime, store_and_fwd_flag, ratecodeid, pulocationid, dolocationid, passenger_count, trip_distance, fare_amount, extra, mta_tax, tip_amount, tolls_amount, improvement_surcharge, total_amount, payment_type, trip_type, congestion_surcharge) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((0, 0, 2, '2019-12-18T15:52:30.000', '2019-12-18T15:54:39.000', 'N', 1, 264, 264, 5, 0.0, 3.5, 0.5, 0.5, 0.01, 0.0, 0.3, 4.81, 1, 1, 0.0), (1, 1, 2, '2020-01-01T00:45:58.000', '2020-01-01T00:56:39.000', 'N', 5, 66, 65, 2, 1.28, 20.0, 0.0, 0.0, 4.06, 0.0, 0.3, 24.36, 1, 2, 0.0), (2, 2, 2, '2020-01-01T00:41:38.000', '2020-01-01T00:52:49.000', 'N', 1, 181, 228, 1, 2.47, 10.5, 0.5, 0.5, 3.54, 0.0, 0.3, 15.34, 1, 1, 0.0), (3, 3, 1, '2020-01-01T00:52:46.000', '2020-01-01T01:14:21.000', 'N', 1, 129, 263, 2, 6.3, 21.0, 3.25, 0.5, 0.0, 0.0, 0.3, 25.05, 2, 1, 2.75), (4, 4, 1, '2020-01-01T00:19:57.000', '2020-01-01T00:30:56.000', 'N', 1, 210, 150, 1, 2.3, 10.0, 0.5, 0.5, 0.0, 0.0, 0.3, 11.3, 1, 1, 0.0), (5, 5, 1, '2020-01-01T00:52:33.000', '2020-01-01T01:09:54.000', 'N', 1, 35, 39, 1, 3.0, 13.5, 0.5, 0.5, 0.0, 0.0, 0.3, 14.8, 1, 1, 0.0), (6, 6, 2, '2020-01-01T00:10:18.000', '2020-01-01T00:22:16.000', 'N', 1, 25, 61, 1, 2.77, 11.0, 0.5, 0.5, 0.0, 0.0, 0.3, 12.3, 2, 1, 0.0), (7, 7, 2, '2020-01-01T01:03:14.000', '2020-01-01T01:29:45.000', 'N', 1, 225, 89, 1, 4.98, 20.5, 0.5, 0.5, 0.0, 0.0, 0.3, 21.8, 2, 1, 0.0)  ... displaying 10 of 2000 total bound parameter sets ...  (1998, 998, 2, '2021-01-02T12:32:45.000', '2021-01-02T12:59:46.000', 'N', 1, 82, 218, 1, 11.88, 35.0, 0.0, 0.5, 0.0, 0.0, 0.3, 35.8, 2, 1, 0.0), (1999, 999, 2, '2021-01-02T12:02:46.000', '2021-01-02T12:09:02.000', 'N', 1, 166, 116, 1, 0.9, 6.0, 0.0, 0.5, 0.0, 0.0, 0.3, 6.8, 2, 1, 0.0))]
(Background on this error at: http://sqlalche.me/e/13/f405)
[2022-02-19 05:46:41,226] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-02-19 05:46:41,296] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
